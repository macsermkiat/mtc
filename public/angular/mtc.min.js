(function(){angular.module("mtcApp").factory("mtcData",e);e.$inject=["$http","$log"];function e(e,t){var o=function(t){return e.get("/api/coaches/search/?text="+t)};var n=function(){return e.get("/api/allcoaches")};var a=function(){return e.get("/api/allcats")};var r=function(t){return e.post("/api/request",t)};var i=function(t){return e.get("/api/coaches/"+t)};var c=function(t){return e.get("/api/user/"+t)};function l(t){return e.post("/api/coaches",t).then(function(e){return e.data})}function s(t){return e.delete("/api/coaches/"+t)}var u=function(t){return e.post("/api/newsletter",t).then(function(e){return e.news})};var f=function(t){return e.post("/api/sendNews",t).then(function(e){return e.mail})};return{allCoaches:n,allCats:a,coachById:i,userById:c,createCoach:l,deleteCoach:s,addNewsLetter:u,sendFirstLetter:f,searchCategoryService:o,requestCoach:r}}})();(function(){angular.module("mtcApp").factory("userService",e);e.$inject=["$http","$log","$window"];function e(e,t,o){var n=function(){return o.localStorage["id_token"]};function a(t){return e.post("/api/users/create",t).then(function(e){return e.data})}function r(t){return e.put("/api/users/update",t).then(function(e){return e.data})}function i(t){return e.put("/api/coachEdit/update",t).then(function(e){return e.data})}return{getToken:n,registerUser:a,updateUser:r,updateCoach:i}}})();(function(){"use strict";angular.module("mtcApp").service("authService",e);e.$inject=["$timeout","$rootScope","lock","authManager","$http","$location","$state","$window"];function e(e,t,o,n,a,r,i,c){var l=JSON.parse(localStorage.getItem("profile"))||{};var s=JSON.parse(localStorage.getItem("subscription"))||{};function u(){return l}function f(e){l=e}function m(){return s}function d(e){s=e}function p(){o.show()}function g(){i.go("/");localStorage.removeItem("id_token");localStorage.removeItem("profile");localStorage.removeItem("subscription");localStorage.removeItem("role");n.unauthenticate();l={};c.location.reload()}function h(){var e=localStorage.getItem("profile");var o=angular.fromJson(e);var n=o.identities[0].user_id;r(n);function r(e){return a.get("/api/user/"+e).then(function(e){var o=e.data[0];if(o==undefined){localStorage.setItem("subscription",false);t.isSubscribed=false}else{localStorage.setItem("subscription",true);t.isSubscribed=true}},function(e){if(e){console.log(e)}})}}function v(){o.on("authenticated",function(a){localStorage.setItem("id_token",a.idToken);n.authenticate();o.getProfile(a.idToken,function(o,n){if(o){console.log(o)}else{localStorage.setItem("profile",JSON.stringify(n));f(n);h();e(function(){var e=localStorage.getItem("role");if(e==="student"){i.go("/")}else if(e==="teacher"){if(t.isSubscribed==false){i.go("subscription")}else if(t.isSubscribed==true){i.go("profile.bio")}}},1e3);t.$broadcast("userProfileSet",n);t.$broadcast("subscriptionSet",s)}})})}return{getUserProfile:u,userProfile:l,userSubscription:s,login:p,logout:g,registerAuthenticationListener:v}}})();(function(){angular.module("mtcApp").controller("homeCtrl",e);e.$inject=["metadataService","$state","$translate","mtcData","$timeout","$uibModal","$rootScope"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n,a,r,i){var c=this;c.message={};c.isAuthenticated=i.isAuthenticated;c.onNewsLetter=function(){c.Error="";if(!c.formLetter.email){c.Error="Email required, please try again";return false}else{c.doAddNewsLetter(c.formLetter)}c.message.success=true;a(function(){c.message.success=false},3e3)};c.changeLanguage=function(e){o.use(e)};c.doAddNewsLetter=function(e){n.addNewsLetter({name:e.name,email:e.email})};c.popupEmailForm=function(){var e=r.open({templateUrl:"/home/email/emailModal.view.html",controller:"emailModalController",controllerAs:"vm"});e.result.then(function(e){console.log(e)})}}})();(function(){angular.module("mtcApp").controller("emailModalController",e);e.$inject=["$uibModalInstance","mtcData","$timeout"];function e(e,t,o){var n=this;n.onSubmit=function(){n.formError="";n.forSuccess="";if(!n.formLetter.role||!n.formLetter.email){n.formError="All fields required, please try again";return false}else{var e=n.formLetter;n.doRequest(e);n.sendFreeCoupon(e)}};n.sendFreeCoupon=function(e){t.sendFirstLetter({email:e.email}).then(function(e){console.log("Your coupon was deliverec to"+email)},function(e){console.log("Something went wrong: "+e)})};n.doRequest=function(e){t.addNewsLetter({role:e.role,email:e.email}).then(function(e){n.formSuccess="Thank you. We will send you a discount code via Email soon";o(function(){n.uibModal.close(e)},3e3)},function(e){n.formError="Your request has not been sent, possible from duplicate Email"})};n.uibModal={close:function(t){e.close(t)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("mtcApp").controller("requestModalCtrl",e);e.$inject=["$uibModalInstance","mtcData","coachData","$timeout"];function e(e,t,o,n){var a=this;a.coachData=o;var r=new Date;var i=localStorage.getItem("profile");var c=angular.fromJson(i);var l;var s=function(){if(c){l=c.identities[0].user_id}else{l=null}};s();a.success=false;a.isDisabled=false;var u;var f=function(){if(o.rating===5){u=490}else{u=290}};f();var m;var d=function(){if(o.price<=5e3){m=490}else{m=o.price/10}};d();a.onSubmit=function(){a.formError="";if(!a.formData.time||!a.formData.place||!a.formData.phone||!a.formData.email||!a.formData.sex){a.formError="All fields required, please try again";return false}else{var e=a.formData;alert("คุณได้ทำการขอแมทช์โค้ช "+o.name+"\nค่าธรรมเนียมการแมทช์ "+u+" บาท\n\n"+"You choosing to match Coach "+o.name+"\nThe matching fee is "+u+" Baht.");a.doRequest(e)}};a.doRequest=function(e){a.success=true;a.isDisabled=true;t.requestCoach({requestid:r.toISOString(),shortDescription:o.shortDescription,coachid:o.coachid,createdBy:o.createdBy,price:o.price,coachMatchingFee:m,studentMatchingFee:u,identity:l,name:e.name,level:e.level,goal:e.goal,time:e.time,place:e.place,phone:e.phone,email:e.email,sex:e.sex}).then(function(e){a.success=true;a.uibModal.close(e)},function(e){a.formError="Your request has not been sent, try again"})};a.uibModal={close:function(t){e.close(t)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("mtcApp").component("ngInitial",function(){return{restrict:"A",controller:["$scope","$element","$attr","$parse",function(e,t,o,n){var a,r,i;i=o.ngInitial||o.value||t.text();a=n(o.ngModel);r=a.assign;r(e,i)}]}})})();(function(){angular.module("mtcApp").controller("profileController",e);e.$inject=["$stateParams","$state","$http","userService","mtcData"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n,a){var r;var i=function(){if(!localStorage.getItem("profile")){alert("Please Log in");t.go("home")}else{r=localStorage.getItem("profile");return r}};i();var c=angular.fromJson(r);var l=c.identities[0].user_id;var s=this;s.profile=c;var u=localStorage.getItem("subscription");s.subscription=u==="true";function f(){a.userById(l).then(function(e){if(e){s.data={coach:e};s.result=s.data.coach.data[0]}else{console.log("Something wrong")}},function(e){console.log(e)})}f()}})();(function(){angular.module("mtcApp").controller("profileCoursesController",e);e.$inject=["$state","$http","mtcData","$filter"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n){var a;var r;var i=function(){if(!localStorage.getItem("profile")){alert("Please Log in");e.go("home")}else{a=localStorage.getItem("profile");subscription=localStorage.getItem("subscription");return a}};i();var c=angular.fromJson(a);var l=c.identities[0].user_id;var s=this;s.subscription=subscription;var u=localStorage.getItem("subscription");s.subscription=u==="true";function f(e){return t.get("/api/users/course",{params:{id:e}}).then(function(e){return e.data})}function m(){return f(l).then(function(e,t){if(t){console.log(t)}else{s.data={coach:e}}})}m();s.deleteCourse=function(t,n){if(confirm("Are you sure to delete "+n+"?")==true){o.deleteCoach(t).then(function(t){console.log("Delete");e.go("profile.bio")},function(e){console.log("error: "+e)})}else{return false}};s.addCoach=function(){var t=localStorage.getItem("subscription");if(t=="false"){alert(n("translate")("PROFILE.ALERT"));e.go("subscription")}else if(t=="true"){e.go("addCoach")}}}})();(function(){angular.module("mtcApp").controller("profileBioController",e);e.$inject=["$stateParams","$http"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t){var o=this;var n=localStorage.getItem("profile");var a=angular.fromJson(n);var r=a.identities[0].user_id;o.profile=a;function i(e){return t.get("/api/users/bio",{params:{id:e}}).then(function(e){return e.data})}function c(){return i(r).then(function(e,t){if(t){console.log(t)}else{o.data={coach:e}}})}c()}})();(function(){angular.module("mtcApp").controller("profileEditController",e);e.$inject=["$scope","userService","$state","$timeout","awsPolicy","$http"];function e(e,t,o,n,a,r){var i=a.getSign();var c=localStorage.getItem("profile");var l=angular.fromJson(c);var s=l.identities[0].user_id;var u=l.identities[0].user_id;e.message={};e.onSubmit=function(){e.formError="";if(!e.user.result.name||!e.user.result.surname||!e.user.result.email||!e.user.result.idnumber||!e.user.result.telephone){e.formError="All fields required, please try again";return false}else{var t=e.user.result;e.doEdit(t)}};var f=new Date;e.doEdit=function(a){t.updateUser({memberSince:f,identity:s,name:a.name,surname:a.surname,email:a.email,picture:l.picture,address:a.address,experience:a.experience,telephone:a.telephone,lineid:a.lineid,idnumber:a.idnumber,education:a.education,term:a.term}).then(function(t){e.message.success=true;n(function(){e.message.success=false},2e3);localStorage.setItem("subscription",true);n(function(){o.go("profile.bio")},2e3)},function(t){var o=Object.keys(t).map(function(e){return t[e]});e.formError="Your edit has not been saved, try again. Possible from duplicate data."});return false};e.resetForm=function(){e.subscription.$setPristine()}}})();(function(){angular.module("mtcApp").controller("coachEditCtrl",e);e.$inject=["$stateParams","$http","mtcData","userService","$log","$scope","$state","$timeout","Upload","awsPolicy","spinnerService"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n,a,r,i,c,l,s,u){var f=this;f.coachid=e.coachid;var m=s.getSign();var d=localStorage.getItem("profile");var p=angular.fromJson(d);var g=p.identities[0].user_id;var h;f.message={};f.isDisabled=false;f.onSubmit=function(){f.formError="";if(!f.formData.name||!f.formData.subject||!f.formData.price||!f.formData.shortDescription||!f.formData.courseDescription||!f.formData.time||!f.formData.province||!f.formData.location||!f.formData.category||!f.formData.courseLength){f.formError="All fields required, please try again";return false}else{var e=f.formData;f.doEdit(e);f.isDisabled=true;f.message.success=true;c(function(){f.message.success=false},1e3).then(function(e){if(e){console.log(error);f.formError="Your edit has not been saved, try again"}else{console.log("YES!")}});i.go("profile.courses")}};v();function v(){return b().then(function(){a.info("View coach by ID")})}function b(){return o.coachById(f.coachid).success(function(e){if(e){f.formData=e;f.imageUrl=e.imageUrl;h=e.imageUrl;oldCategory=e.category}else{console.log("Error: no coachid found")}console.log("coachid found")}).error(function(e){console.log(e)})}f.doEdit=function(e){n.updateCoach({createdDate:S,coachid:f.coachid,name:e.name,price:e.price,subject:e.subject,shortDescription:e.shortDescription,courseDescription:e.courseDescription,preparation:e.preparation,group:e.group,time:e.time,courseLength:e.courseLength,level:e.level,location:e.location,province:e.province,category:e.category,imageUrl:h,videoid:e.videoid,oldCategory:oldCategory});return false};f.resetForm=function(){r.subscription.$setPristine()};var w=new Date;var S=w.toISOString();r.beforeResizingImages=function(e){u.show("picturespinner")};r.afterResizingImages=function(e){u.hide("picturespinner")};r.uploadPic=function(e){alert("เมื่อ upload หรือเปลี่ยนรูปใหม่เสร็จ ต้องทำการ submit แบบฟอร์มทั้งหมดที่ปุ่ม Submit ด้านล่างสุดบรรทัดสุดท้ายด้วยทุกครั้ง\nEverytime you finish upload or change the new picture. Please submit the whole form via the button beneath last line");Promise.resolve(m).then(function(e){return e}).then(function(t){l.upload({url:"https://matchthecoach.s3.amazonaws.com",method:"POST",data:{key:"coaches/"+S,AWSAccessKeyId:t.s3AccessKeyId,acl:"public-read",policy:t.s3Policy,signature:t.s3Signature,"Content-Type":e.type!=""?e.type:"application/octet-stream",filename:e.name,file:e}}).then(function(e){c(function(){r.result=e.data})},function(e){if(e.status>0)r.errorMsg=e.status+":"+e.data},function(e){r.progress=Math.min(100,parseInt(100*e.loaded/e.total));h="https://s3-ap-southeast-1.amazonaws.com/matchthecoach/coaches/"+S})})};function y(){return o.allCats().success(function(e){f.data={cat:e}}).error(function(e){f.message="Sorry, something's gone wrong"})}y()}})();(function(){angular.module("mtcApp").controller("subscriptionCtrl",e);e.$inject=["userService","$state","$timeout","$window","Upload","$scope","awsPolicy","mtcData"];function e(e,t,o,n,a,r,i,c){var l=this;var s=i.getSign();var u=localStorage.getItem("profile");var f=angular.fromJson(u);var m=f.identities[0].user_id;var d=localStorage.getItem("role");l.message={};l.isDisabled=false;l.onSubmit=function(){l.formError="";if(!l.formData.name||!l.formData.surname||!l.formData.email||!l.formData.idnumber||!l.formData.telephone){l.formError="All fields required, please try again";return false}else{var e=l.formData;l.doSubscription(e)}};var p=new Date;l.doSubscription=function(a){e.registerUser({memberSince:p,identity:m,name:a.name,surname:a.surname,email:a.email,picture:f.picture,address:a.address,experience:a.experience,telephone:a.telephone,lineid:a.lineid,idnumber:a.idnumber,education:a.education,terms:a.terms,role:a.role}).then(function(e){l.doAddNewsLetter(a);l.isDisabled=true;l.message.success=true;o(function(){l.message.success=false},2e3);localStorage.setItem("subscription",true);if(d==="teacher"){o(function(){t.go("addCoach")},2e3)}else{o(function(){t.go("/")},2e3);o(function(){n.location.reload()},2500)}},function(e){var t=Object.keys(e).map(function(t){return e[t]});l.formError="Your edit has not been saved, try again. Check your mobile and Email field. Mobile number should contain ONLY number, without -"});return false};l.resetForm=function(){l.subscription.$setPristine()};l.doAddNewsLetter=function(e){c.addNewsLetter({name:e.name,email:e.email,role:e.role})}}})();(function(){angular.module("mtcApp").controller("searchCtrl",e);e.$inject=["metadataService","$stateParams","$http","mtcData","$log","$uibModal"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n,a,r){var i=this;i.text=t.text;c();e.loadMetadata({title:"รายชื่อครูผู้เชี่ยวชาญ "+i.text});function c(){return s().then(function(){a.info("Search coaches by keyword.")})}var l=function(e){var t=e.length,o,n;while(t){n=Math.floor(Math.random()*t--);o=e[t];e[t]=e[n];e[n]=o}return e};function s(){return n.searchCategoryService(i.text).then(function(e){i.data={coach:e.data};l(i.data.coach)}).catch(function(e){i.message="Sorry, something's gone wrong"})}i.popupHelp=function(){var e=r.open({templateUrl:"/home/helpModal.view.html"});e.result.then(function(e){console.log("Help")})}}})();(function(){angular.module("mtcApp").controller("coachDetailCtrl",e);e.$inject=["$stateParams","metadataService","$http","mtcData","$log","$scope","$uibModal","$rootScope","$state"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n,a,r,i,c,l){var s=this;s.coachid=e.coachid;t.loadMetadata({title:"รายละเอียดโค้ช "+s.coachid});r.playerVars={autoplay:0};r.vdo=null;f();function u(){var e=document.querySelector(".js-textareacopybtn");e.addEventListener("click",function(e){var t=document.querySelector(".js-copytextarea");t.select();try{var o=document.execCommand("copy");var n=o?"successful":"unsuccessful";console.log("Copying text command was "+n)}catch(e){console.log("Oops, unable to copy")}})}u();function f(){return m().then(function(){a.info("View coach by ID")})}function m(){return n.coachById(s.coachid).then(function(e){if(e){s.data={coach:e.data};r.videoid=e.videoid;r.vdo=true}else{r.vdo=false}}).catch(function(e){console.log(e)})}s.popupRequestForm=function(){var e=i.open({templateUrl:"/common/request/requestModal.view.html",controller:"requestModalCtrl",controllerAs:"vm",resolve:{coachData:function(){return{coachid:s.coachid,shortDescription:s.data.coach.shortDescription,createdBy:s.data.coach.createdBy,price:s.data.coach.price,length:s.data.coach.length,name:s.data.coach.name,rating:s.data.coach.rating}}}});e.result.then(function(e){console.log(e)})}}})();(function(){angular.module("mtcApp").controller("userDetailController",e);e.$inject=["$stateParams","$http","mtcData"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o){var n=this;var a=e.userid;n.teacher="";function r(){o.userById(a).then(function(e){if(e){n.data={coach:e};n.teacher=n.data.coach.data[0]}else{console.log("Something wrong")}},function(e){console.log(e)})}r()}})();(function(){angular.module("mtcApp").controller("addCoachCtrl",e);e.$inject=["mtcData","$scope","$state","$timeout","$window","Upload","awsPolicy","spinnerService"];function e(e,t,o,n,a,r,i,c){var l=this;var s=i.getSign();var u=localStorage.getItem("profile");var f=angular.fromJson(u);var m=f.identities[0].user_id;l.formData="";l.formData.sale=0;t.$watch("vm.formData.sale",function(){l.presale=l.formData.price*(100/(100-l.formData.sale))});l.message={};l.isDisabled=false;n(function(){alert("Please noted that it is prohibited to give out your contact (Telephone number ,LINE ID, email, or facebook contact, etc.) Your account will be banned if you break the rules.\n\nทางเราไม่อนุญาตให้ครูทุกท่านโพสเบอร์ติดต่อ LINE ID, facebook, Email หรือการติดต่อทุกชนิดในช่องที่ไม่ได้สำหรับให้กรอกสิ่งเหล่านี้ ถ้าฝ่าฝืนจะถูกแบนแอคเคานท์ทันที ขออภัยในความไม่สะดวก")},2e3);l.onSubmit=function(){l.formError="";if(!l.formData.name||!l.formData.subject||!l.formData.price||!l.formData.shortDescription||!l.formData.courseDescription||!l.formData.time||!l.formData.province||!l.formData.location||!l.formData.category||!l.formData.courseLength){l.formError="All fields required, please try again";return false}else{var e=l.formData;l.doAddCoach(e)}};var d=new Date;var p=d.toISOString();l.doAddCoach=function(t){e.createCoach({createdDate:p,name:t.name,price:t.price,sale:t.sale,subject:t.subject,shortDescription:t.shortDescription,courseDescription:t.courseDescription,preparation:t.preparation,group:t.group,time:t.time,courseLength:t.courseLength,level:t.level,location:t.location,province:t.province,category:t.category,videoid:t.videoid,createdBy:m}).then(function(e){l.isDisabled=true;l.message.success=true;n(function(){l.message.success=false},2e3);n(function(){o.go("/")},2e3);n(function(){a.location.reload()},2500)},function(e){var t=Object.keys(e).map(function(t){return e[t]});l.formError="Your course has not been added, try again. Possible from duplicate data."});return false};l.resetForm=function(){l.addCoach.$setPristine()};t.beforeResizingImages=function(e){c.show("picturespinner")};t.afterResizingImages=function(e){c.hide("picturespinner")};t.uploadPic=function(e){alert("เมื่อ upload หรือเปลี่ยนรูปใหม่เสร็จ ต้องทำการ submit แบบฟอร์มทั้งหมดที่ปุ่ม Submit ด้านล่างสุดบรรทัดสุดท้ายด้วยทุกครั้ง\nEverytime you finish upload or change the new picture. Please submit the whole form via the button beneath last line");Promise.resolve(s).then(function(e){return e}).then(function(o){r.upload({url:"https://matchthecoach.s3.amazonaws.com",method:"POST",data:{key:"coaches/"+p,AWSAccessKeyId:o.s3AccessKeyId,acl:"public-read",policy:o.s3Policy,signature:o.s3Signature,"Content-Type":e.type!=""?e.type:"application/octet-stream",filename:e.name,file:e}}).then(function(e){n(function(){t.result=e.data})},function(e){if(e.status>0)t.errorMsg=e.status+":"+e.data},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total))})})};function g(){return e.allCats().success(function(e){l.data={cat:e}}).error(function(e){l.message="Sorry, something's gone wrong"})}g()}})();(function(){angular.module("mtcApp").component("navigation",{restrict:"EA",templateUrl:"common/navigationAndfooter/navigation.template.html",controller:"loginController",controllerAs:"lgin"})})();(function(){angular.module("mtcApp").component("footerGeneric",{templateUrl:"/common/navigationAndfooter/footerGeneric.template.html"})})();(function(){angular.module("mtcApp").component("landing",{restrict:"EA",templateUrl:"/home/landing.template.html",controller:"loginController",controllerAs:"lgin"})})();(function(){angular.module("mtcApp").controller("SearchBoxController",e);e.$inject=["$state","mtcData","$timeout","$http"];if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}function e(e,t,o,n){var a=this;a.text="";a.onSelect=function(e,t,o){a.$item=e;a.$model=t;a.$label=o};a.onSubmit=function(t){if(a.text!==""){e.go("search",{text:a.text})}};a.searching=function(e){return n.get("api/coaches/searchCat",{params:{text:e}}).then(function(e){return e.data})};r();function r(){return t.allCats().then(function(e){a.data={cat:e.data}}).catch(function(e){a.message="Sorry, something's gone wrong"})}a.addModel=function(t){a.text=t;e.go("search",{text:a.text})}}})();(function(){angular.module("mtcApp").component("searchbox",{restrict:"E",templateUrl:"/common/searchbox/searchbox.template.html",bindings:{text:"<"},controller:"SearchBoxController",controllerAs:"vm"})})();(function(){angular.module("mtcApp").factory("awsPolicy",e);e.$inject=["$http","$log"];function e(e,t){var o=function(){return e.get("/api/awsPolicy").then(function(e){return e.data})};return{getSign:o}}})();(function(){angular.module("mtcApp").controller("loginController",e);e.$inject=["authService","$translate","$rootScope","$scope","$state","$timeout","$uibModal"];function e(e,t,o,n,a,r,i){var c=this;c.authService=e;c.changeLanguage=function(e){t.use(e)};c.getSubscription=o.isSubscribed;c.serviceSubscription=o.authService.userSubscription;c.isAuthenticated=o.isAuthenticated;c.localStorageSubscription=localStorage.getItem("subscription");r(function(){c.getSubscription=o.isSubscribed},1e3);o.$on("userProfileSet",function(e,t){c.isAuthenticated=o.isAuthenticated;c.profile=t});o.$on("subscriptionSet",function(e,t){r(function(){c.getSubscription=o.isSubscribed},1e3)});var l=localStorage.getItem("profile");if(l){c.profile=angular.fromJson(l)}var s=new Auth0Lock("2m8hbwYC8UdyjITdKGDptrRvF6BXweY7","royyak.auth0.com");s.on("authenticated",function(e){s.getProfile(e.idToken,function(t,o){if(t){console.log(t);return}if(o){localStorage.setItem("id_token",e.idToken);localStorage.setItem("profile",JSON.stringify(profile))}return})});c.addCoach=function(){var e=localStorage.getItem("subscription");if(e=="false"){alert($filter("translate")("PROFILE.ALERT"));a.go("subscription")}else if(e=="true"){a.go("addCoach")}};c.student=function(){localStorage.setItem("role","student");e.login()};c.teacher=function(){localStorage.setItem("role","teacher");a.go("become")};c.becomeCoach=function(){if(o.isAuthenticated===false){e.login()}else if(o.isAuthenticated===true){a.go("profile.bio")}};c.popupHelp=function(){var e=i.open({templateUrl:"/home/helpModal.view.html"});e.result.then(function(e){console.log("Help")})}}})();(function(){angular.module("mtcApp").controller("twitCtrl",e);e.$inject=["$http","$timeout"];function e(e,t){var o=this;o.groupReply=[];o.nameAdded=[];o.add="";o.replyTo="";o.name="";o.message={};o.isLoading=false;o.namePresent="";o.addGroupReply=function(e,t){var n={name:e,id:t};o.groupReply.push(n);o.nameAdded.push(e);o.replyTo=o.groupReply.toString();o.name=o.groupReply[o.groupReply.length-1].name;o.id=o.groupReply[o.groupReply.length-1].id};o.onSubmit=function(){o.formError="";if(!o.formData.tweet){o.formError="All fields required, please try again";return false}else{var e=o.formData;o.callTweet(e)}};o.today=function(){o.date=new Date};o.today();o.clear=function(){o.date=null};o.format="yyyy-MM-dd";o.getTwitter=function(t,n){o.isLoading=true;return e({url:"/api/twit",method:"GET",params:{text:t,date:n}}).then(function(e){if(e){o.data={twit:e}}else{console.log("Something wrong")}o.isLoading=false},function(e){console.log(e);o.isLoading=false})};o.callTweet=function(e){var a=o.formData;n({tweet:e.tweet,name:o.name,id:o.id}).then(function(e){o.message.success=true;t(function(){o.message.success=false},1e3)},function(e){console.log(e);o.formError="Something wrong! Tweet not sent."})};var n=function(t){return e.post("/api/tweet",t)}}})();(function(){angular.module("mtcApp").factory("metadataService",e);e.$inject=["$http","$rootScope","$window"];function e(t,o,n){var a=this;var r=function(e){a.title=document.title=e.title||"Match The Coach";a.description=document.description=e.description||"Match The Coach"};return{loadMetadata:r,restrict:"A",scope:{metaproperty:"@"},link:function t(o,n,a){o.default=n.attr("content");o.metadata=e;o.$watch("metadata",function(e,t){r(e)},true);function r(e){var t=e[o.metaproperty]||o.default;n.attr("content",t)}r(o.metadata)}}}})();(function(){angular.module("mtcApp").filter("addHtmlLineBreaks",e);function e(){return function(e){var t=angular.isDefined(e)?e.replace(/\n/g,"<br/>"):"";return t}}})();